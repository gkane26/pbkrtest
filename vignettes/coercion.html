<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
           "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<meta name="GENERATOR" content="TtH 4.12">
 <style type="text/css"> div.p { margin-top: 7pt;}</style>
 <style type="text/css"><!--
 td div.comp { margin-top: -0.6ex; margin-bottom: -1ex;}
 td div.comb { margin-top: -0.6ex; margin-bottom: -.6ex;}
 td div.hrcomp { line-height: 0.9; margin-top: -0.8ex; margin-bottom: -1ex;}
 td div.norm {line-height:normal;}
 span.roman {font-family: serif; font-style: normal; font-weight: normal;} 
 span.overacc2 {position: relative;  left: .8em; top: -1.2ex;}
 span.overacc1 {position: relative;  left: .6em; top: -1.2ex;} --></style>
 <style type="text/css"><!--
 .tiny {font-size:30%;}
 .scriptsize {font-size:xx-small;}
 .footnotesize {font-size:x-small;}
 .smaller {font-size:smaller;}
 .small {font-size:small;}
 .normalsize {font-size:medium;}
 .large {font-size:large;}
 .larger {font-size:x-large;}
 .largerstill {font-size:xx-large;}
 .huge {font-size:300%;}
 --></style>
 


<title> Coercion between model objects and restriction matrices in the \pkg{pbkrtest} package</title>
 
<h1 align="center">Coercion between model objects and restriction matrices in the <tt>pbkrtest</tt> package </h1>

<h3 align="center">S&#248;ren H&#248;jsgaard and Ulrich Halekoh </h3>

<h3 align="center"><tt>pbkrtest</tt> version 0.4-9.0 as of 2020-12-03 </h3>

<div class="p"><!----></div>
 
<div class="p"><!----></div>

<div class="p"><!----></div>

<div class="p"><!----></div>
Consider regression models for the `cars` dataset:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;mod0&nbsp;&lt;-&nbsp;lm(dist&nbsp;~&nbsp;1,&nbsp;data=cars);&nbsp;coef(mod0)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
(Intercept)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;42.98&nbsp;
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;mod1&nbsp;&lt;-&nbsp;update(mod0,&nbsp;.~.&nbsp;+&nbsp;speed);&nbsp;coef(mod1)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
(Intercept)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;speed&nbsp;
&nbsp;-17.579095&nbsp;&nbsp;&nbsp;&nbsp;3.932409&nbsp;
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;mod2&nbsp;&lt;-&nbsp;update(mod1,&nbsp;.~.&nbsp;+&nbsp;I(speed^2));&nbsp;coef(mod2)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
(Intercept)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;speed&nbsp;&nbsp;I(speed^2)&nbsp;
&nbsp;&nbsp;2.4701378&nbsp;&nbsp;&nbsp;0.9132876&nbsp;&nbsp;&nbsp;0.0999593&nbsp;
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
Reducing `mod2` to `mod0` corresponds to restricting the model space for
`mod2` and so on:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;L21&nbsp;&lt;-&nbsp;model2remat(mod2,&nbsp;mod1);&nbsp;L21
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,2]&nbsp;[,3]
[1,]&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;-1.544314e-17&nbsp;&nbsp;&nbsp;&nbsp;1
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;L20&nbsp;&lt;-&nbsp;model2remat(mod2,&nbsp;mod0);&nbsp;L20
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,3]
[1,]&nbsp;0.000000e+00&nbsp;-0.03309061&nbsp;-0.99945236
[2,]&nbsp;5.724587e-15&nbsp;-0.99945236&nbsp;&nbsp;0.03309061
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;L10&nbsp;&lt;-&nbsp;model2remat(mod1,&nbsp;mod0);&nbsp;L10
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[,1]&nbsp;[,2]
[1,]&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;-1
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
The other way around is that given a restriction matrix and a large
model, we can construct the corresponding smaller model:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;new1&nbsp;&nbsp;&lt;-&nbsp;remat2model(mod2,&nbsp;L21);&nbsp;coef(new1)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.X1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.X2&nbsp;
&nbsp;3.932409&nbsp;17.579095&nbsp;
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;new0a&nbsp;&lt;-&nbsp;remat2model(mod2,&nbsp;L20);&nbsp;coef(new0a)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
&nbsp;&nbsp;.X1&nbsp;
42.98&nbsp;
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;new0b&nbsp;&lt;-&nbsp;remat2model(mod1,&nbsp;L10);&nbsp;coef(new0b)
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
&nbsp;&nbsp;.X1&nbsp;
42.98&nbsp;
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>
It should be checked that the original and new model matrices span the
same space. For now we will simply check that the fitted values are
practically identical:

<div class="p"><!----></div>
   <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;eps&nbsp;&lt;-&nbsp;1e-8
R&#62;&nbsp;max(abs(fitted(new1)&nbsp;&nbsp;-&nbsp;fitted(mod1)))&nbsp;&lt;&nbsp;eps
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
[1]&nbsp;TRUE
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;max(abs(fitted(new0a)&nbsp;-&nbsp;fitted(mod0)))&nbsp;&lt;&nbsp;eps
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
[1]&nbsp;TRUE
&nbsp;
</pre> </b></span>
  <span style="color:#FF0000"><b>
<pre>
R&#62;&nbsp;max(abs(fitted(new0b)&nbsp;-&nbsp;fitted(mod0)))&nbsp;&lt;&nbsp;eps
&nbsp;
</pre> </b></span>
  <span style="color:#0000FF"><b>
<pre>
[1]&nbsp;TRUE
&nbsp;
</pre> </b></span>

<div class="p"><!----></div>

<br /><br /><hr /><small>File translated from
T<sub><span class="small">E</span></sub>X
by <a href="http://hutchinson.belmont.ma.us/tth/">
T<sub><span class="small">T</span></sub>H</a>,
version 4.12.</small>
</html>
